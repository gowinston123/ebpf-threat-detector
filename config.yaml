# eBPF Threat Detector Configuration

# Logging settings
logging:
  level: info           # debug, info, warn, error
  format: text          # text, json
  output: stdout        # stdout, file
  file_path: /var/log/ebpf-detector.log

# Alert settings
alerts:
  enabled: true
  webhook_url: ""       # Optional: Slack/Discord webhook
  log_file: /var/log/ebpf-alerts.log

# Detection rules
rules:
  # Process execution monitoring
  execve:
    enabled: true
    suspicious_binaries:
      - /bin/sh
      - /bin/bash
      - /bin/nc
      - /usr/bin/nc
      - /bin/netcat
      - /usr/bin/ncat
      - /usr/bin/wget
      - /usr/bin/curl
      - /usr/bin/base64
      - /usr/bin/python
      - /usr/bin/python3
      - /usr/bin/perl
      - /usr/bin/ruby

    # Alert if these are executed by non-root
    alert_non_root: true

  # Privilege escalation detection
  privilege_escalation:
    enabled: true
    monitor_setuid: true
    monitor_setgid: true
    monitor_capabilities: true

  # Process monitoring
  process:
    enabled: true
    # Ignore events from these processes
    ignore_comm:
      - systemd
      - sshd
      - containerd
